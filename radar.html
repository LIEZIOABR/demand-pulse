<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABR ‚Äî Demand Pulse Radar</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg: #0a0c10;
            --card-bg: #12151a;
            --accent: #00c6ff;
            --accent-glow: rgba(0, 198, 255, 0.4);
            --text-main: #e2e8f0;
            --text-dim: #94a3b8;
            --border: rgba(255, 255, 255, 0.08);
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: var(--text-main); padding: 20px; min-height: 100vh; }

        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding: 0 10px; }
        .logo { height: 40px; filter: drop-shadow(0 0 10px var(--accent-glow)); }
        .btn-exit { background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: var(--text-main); padding: 8px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: 0.3s; text-decoration: none; font-size: 0.9rem; }
        .btn-exit:hover { background: rgba(255,255,255,0.1); border-color: var(--text-dim); }

        .main-grid { display: grid; grid-template-columns: 1fr 350px; gap: 25px; max-width: 1600px; margin: 0 auto; }

        .chart-container { background: var(--card-bg); border: 1px solid var(--border); border-radius: 20px; padding: 30px; position: relative; height: 500px; }
        .chart-title { color: var(--accent); font-weight: 800; font-size: 1.1rem; margin-bottom: 25px; text-transform: uppercase; letter-spacing: 1px; display: flex; justify-content: space-between; align-items: center; }

        .bulletin-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 20px; padding: 25px; display: flex; flex-direction: column; height: 500px; }
        .bulletin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .bulletin-title { font-weight: 800; font-size: 1.1rem; color: var(--text-main); text-transform: uppercase; }
        .copy-btn { background: transparent; border: 1px solid var(--accent); color: var(--accent); padding: 6px 12px; border-radius: 15px; font-size: 0.7rem; font-weight: 800; cursor: pointer; transition: 0.3s; }
        .copy-btn:hover { background: var(--accent); color: #000; }
        .bulletin-content { flex: 1; overflow-y: auto; font-family: 'Fira Code', monospace; font-size: 0.85rem; color: var(--text-dim); line-height: 1.6; padding-right: 10px; }
        .bulletin-content::-webkit-scrollbar { width: 4px; }
        .bulletin-content::-webkit-scrollbar-thumb { background: var(--border); border-radius: 10px; }
        .bulletin-section { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid var(--border); }
        .bulletin-h { color: var(--accent); font-weight: 700; margin-bottom: 5px; }

        .destinations-grid { grid-column: span 2; display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-top: 10px; }
        .dest-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 24px; padding: 25px; position: relative; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: flex; flex-direction: column; min-height: 720px; }
        .dest-card:hover { transform: translateY(-5px); border-color: var(--accent); box-shadow: 0 15px 30px rgba(0,0,0,0.4); }

        /* ABR Score Badge */
        .abr-score-badge {
            position: absolute; top: 20px; right: 20px; width: 70px; height: 70px;
            border-radius: 50%; background: rgba(0,0,0,0.3); border: 2px solid var(--accent);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 0 15px var(--accent-glow); z-index: 10;
        }
        .score-value { font-size: 1.4rem; font-weight: 800; color: var(--accent); line-height: 1; }
        .score-label { font-size: 0.5rem; font-weight: 700; text-transform: uppercase; color: var(--text-dim); margin-top: 2px; }

        .dest-header { margin-bottom: 20px; padding-right: 80px; }
        .dest-name { font-size: 1.6rem; font-weight: 800; margin-bottom: 5px; color: #fff; }
        
        .tactic-badges { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 20px; 
            min-height: 85px; align-content: start;
        }
        .badge { padding: 6px 12px; border-radius: 8px; font-size: 0.65rem; font-weight: 800; text-transform: uppercase; text-align: center; letter-spacing: 0.5px; }
        .badge-share { background: rgba(255,255,255,0.05); color: #fff; border: 1px solid var(--border); grid-column: span 2; display: flex; justify-content: space-between; align-items: center; }
        .badge-share span { color: var(--accent); }
        .badge-status { background: rgba(0, 198, 255, 0.1); color: var(--accent); border: 1px solid var(--accent); }
        .badge-alert { background: rgba(239, 68, 68, 0.1); color: var(--danger); border: 1px solid var(--danger); }
        .badge-warning { background: rgba(245, 158, 11, 0.1); color: var(--warning); border: 1px solid var(--warning); }
        .badge-social { background: rgba(168, 85, 247, 0.1); color: #a855f7; border: 1px solid #a855f7; }

        .metric-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .metric-box { background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 15px; padding: 15px; }
        .metric-label { font-size: 0.65rem; font-weight: 700; color: var(--text-dim); text-transform: uppercase; margin-bottom: 8px; letter-spacing: 1px; }
        .metric-value { font-size: 1.1rem; font-weight: 700; display: flex; align-items: center; gap: 8px; }

        .origin-tag { background: rgba(245, 158, 11, 0.1); border: 1px solid var(--warning); border-radius: 10px; padding: 12px; margin-bottom: 20px; font-size: 0.8rem; font-weight: 600; color: var(--warning); }
        
        .progress-container { margin-bottom: 20px; }
        .progress-header { display: flex; justify-content: space-between; font-size: 0.7rem; font-weight: 700; color: var(--text-dim); text-transform: uppercase; margin-bottom: 8px; }
        .progress-bar { height: 8px; background: rgba(255,255,255,0.05); border-radius: 4px; overflow: hidden; position: relative; }
        .progress-fill { height: 100%; background: var(--accent); border-radius: 4px; transition: 1s ease-out; }
        .progress-split { position: absolute; top: 0; left: 50%; width: 2px; height: 100%; background: rgba(255,255,255,0.2); }

        .insight-box { background: rgba(0, 198, 255, 0.05); border-left: 3px solid var(--accent); padding: 15px; border-radius: 0 12px 12px 0; margin-bottom: 20px; font-size: 0.85rem; line-height: 1.5; color: var(--text-main); }
        
        .weather-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: auto; padding-top: 20px; border-top: 1px solid var(--border); }
        .weather-day { text-align: center; }
        .weather-temp { font-size: 0.9rem; font-weight: 800; margin-bottom: 2px; }
        .weather-label { font-size: 0.6rem; color: var(--text-dim); text-transform: uppercase; }

        .recommendation-box {
            margin-top: 15px; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.02);
            border: 1px dashed var(--border); font-size: 0.75rem; font-weight: 600; color: var(--accent);
            text-align: center;
        }

        @media (max-width: 1100px) {
            .main-grid { grid-template-columns: 1fr; }
            .bulletin-card { height: 400px; }
            .destinations-grid { grid-column: span 1; }
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="logo.png" alt="ABR Logo" class="logo">
        <a href="index.html" class="btn-exit">Sair do Sistema</a>
    </div>

    <div class="main-grid">
        <div class="chart-container">
            <div class="chart-title">
                TEND√äNCIA DE DEMANDA CONSOLIDADA (60 DIAS)
            </div>
            <canvas id="mainChart"></canvas>
        </div>

        <div class="bulletin-card">
            <div class="bulletin-header">
                <div class="bulletin-title">BOLETIM ESTRAT√âGICO ABR</div>
                <button class="copy-btn" onclick="copyBulletin()">COPIAR BOLETIM</button>
            </div>
            <div class="bulletin-content" id="bulletin-text">
                Carregando intelig√™ncia de mercado...
            </div>
        </div>

        <div class="destinations-grid" id="destinations-container">
            <!-- Cards gerados via JS -->
        </div>
    </div>

    <script>
        let pulseData = null;
        let chartInstance = null;

        async function init() {
            try {
                const response = await fetch('pulse-data.json');
                if (!response.ok) throw new Error('Erro ao carregar dados');
                pulseData = await response.json();
                
                renderChart();
                renderCards();
                renderBulletin();
            } catch (error) {
                console.error(error);
                document.getElementById('bulletin-text').innerHTML = '<span style="color:var(--danger)">Erro cr√≠tico: pulse-data.json n√£o encontrado.</span>';
            }
        }

        function renderChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(0, 198, 255, 0.3)');
            gradient.addColorStop(1, 'rgba(0, 198, 255, 0)');

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: pulseData.chartData.labels,
                    datasets: [{
                        label: 'Volume de Buscas',
                        data: pulseData.chartData.values,
                        borderColor: '#00c6ff',
                        borderWidth: 3,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#00c6ff',
                        fill: true,
                        backgroundColor: gradient,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false }, tooltip: { mode: 'index', intersect: false } },
                    scales: {
                        y: { display: false },
                        x: { grid: { display: false }, ticks: { color: '#94a3b8', font: { size: 10 } } }
                    }
                }
            });
        }

        function calculateABRScore(dest) {
            // Pesos: Press√£o (40%), Humor (30%), Clima (30%)
            const p = dest.bookingPressure || 0;
            const h = dest.sentiment === 'Positivo' ? 100 : (dest.sentiment === 'Neutro' ? 60 : 30);
            const c = dest.iecValue || 70; 
            
            const score = Math.round((p * 0.4) + (h * 0.3) + (c * 0.3));
            
            let label = "Est√°vel";
            let color = "var(--accent)";
            let recommendation = "Cen√°rio de estabilidade. Manter estrat√©gia atual.";

            if (score >= 90) { 
                label = "Cr√≠tico"; 
                color = "var(--accent)"; 
                recommendation = "üí° Cen√°rio favor√°vel para revis√£o tarif√°ria agressiva.";
            }
            else if (score >= 70) { 
                label = "Acelera√ß√£o"; 
                color = "var(--warning)"; 
                recommendation = "üéØ Recomendado refor√ßo em canais de convers√£o imediata.";
            }
            else if (score < 50) { 
                label = "Retra√ß√£o"; 
                color = "var(--danger)"; 
                recommendation = "‚ö†Ô∏è Momento de preserva√ß√£o de margem e revis√£o de posicionamento.";
            }
            
            return { score, label, color, recommendation };
        }

        function renderCards() {
            const container = document.getElementById('destinations-container');
            container.innerHTML = pulseData.destinations.map(dest => {
                const abr = calculateABRScore(dest);
                return `
                <div class="dest-card">
                    <div class="abr-score-badge" style="border-color: ${abr.color}; box-shadow: 0 0 15px ${abr.color}66;">
                        <div class="score-value" style="color: ${abr.color}">${abr.score}</div>
                        <div class="score-label">ABR SCORE</div>
                    </div>

                    <div class="dest-header">
                        <div class="dest-name">${dest.name}</div>
                    </div>

                    <div class="tactic-badges">
                        <div class="badge badge-share">MARKET SHARE <span>${dest.marketShare}% ${dest.shareTrend === 'up' ? '‚ñ≤' : '‚ñº'}</span></div>
                        <div class="badge badge-status">${dest.status}</div>
                        ${dest.bookingPressure > 85 ? '<div class="badge badge-alert">PRESS√ÉO CR√çTICA</div>' : ''}
                        ${dest.originPower > 70 ? '<div class="badge badge-warning">GATILHO 48H ATIVO</div>' : ''}
                        ${dest.growth.includes('+') ? '<div class="badge badge-social">SOCIAL BUZZ</div>' : ''}
                    </div>

                    <div class="metric-row">
                        <div class="metric-box">
                            <div class="metric-label">Humor do Mercado</div>
                            <div class="metric-value">
                                ${dest.sentiment === 'Positivo' ? 'üòä' : (dest.sentiment === 'Neutro' ? 'üòê' : 'üòü')}
                                ${dest.sentiment}
                            </div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-label">Press√£o de Reserva</div>
                            <div class="metric-value">
                                ${dest.bookingPressure > 80 ? 'üö®' : 'üìà'}
                                ${dest.bookingPressure}%
                            </div>
                        </div>
                    </div>

                    <div class="origin-tag">
                        üìç Origem Dominante: ${dest.topOrigin} (${dest.originPower}%)
                    </div>

                    <div class="progress-container">
                        <div class="progress-header">
                            <span>Perfil de P√∫blico</span>
                            <span>${dest.publicProfile}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${dest.publicProfile.split('|')[0]}"></div>
                            <div class="progress-split"></div>
                        </div>
                    </div>

                    <div class="progress-container">
                        <div class="progress-header">
                            <span>Inten√ß√£o de Estadia</span>
                            <span>${dest.stayIntent}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${dest.stayIntent.split('|')[0]}; background: #a855f7;"></div>
                            <div class="progress-split"></div>
                        </div>
                    </div>

                    <div class="insight-box">
                        üí° ${dest.insight}
                    </div>

                    <div class="recommendation-box" style="color: ${abr.color}; border-color: ${abr.color}44;">
                        ${abr.recommendation}
                    </div>

                    <div class="weather-grid">
                        ${dest.weather.map(w => `
                            <div class="weather-day">
                                <div class="weather-temp">${w.temp}¬∞</div>
                                <div class="weather-label">${w.cond}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `}).join('');
        }

        function renderBulletin() {
            const container = document.getElementById('bulletin-text');
            let html = `
                <div class="bulletin-section">
                    <div class="bulletin-h">üèÜ MARKET SHARE CONSOLIDADO</div>
                    ${pulseData.destinations.map(d => `‚Ä¢ ${d.name}: ${d.marketShare}% ${d.shareTrend === 'up' ? '‚ñ≤' : '‚ñº'}`).join('<br>')}
                </div>
            `;

            pulseData.destinations.slice(0, 4).forEach(d => {
                const abr = calculateABRScore(d);
                html += `
                    <div class="bulletin-section">
                        <div class="bulletin-h">üìç ${d.name.toUpperCase()} (SCORE: ${abr.score})</div>
                        ‚Ä¢ Status: ${d.status} (${d.growth} var)<br>
                        ‚Ä¢ Sentimento: ${d.sentiment}<br>
                        ‚Ä¢ Press√£o: ${d.bookingPressure}%<br>
                        ‚Ä¢ Recomenda√ß√£o: ${abr.label}
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function copyBulletin() {
            const text = document.getElementById('bulletin-text').innerText;
            navigator.clipboard.writeText(text);
            const btn = document.querySelector('.copy-btn');
            btn.innerText = 'COPIADO!';
            setTimeout(() => btn.innerText = 'COPIAR BOLETIM', 2000);
        }

        init();
    </script>
</body>
</html>
